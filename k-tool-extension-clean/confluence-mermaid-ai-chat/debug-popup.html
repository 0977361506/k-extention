<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Popup</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        .test-btn {
            background: #0052cc;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 10px;
            border-radius: 4px;
            cursor: pointer;
        }
        .test-btn:hover {
            background: #0747a6;
        }
        #debug-info {
            background: #f5f5f5;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <h1>üêõ Debug Popup Display</h1>
    
    <button class="test-btn" onclick="testPopupDisplay()">Test Popup Display</button>
    <button class="test-btn" onclick="forceShowPopup()">Force Show Popup</button>
    <button class="test-btn" onclick="checkPopupStatus()">Check Popup Status</button>
    <button class="test-btn" onclick="clearDebug()">Clear Debug</button>
    
    <div id="debug-info"></div>

    <script>
        function log(message) {
            const debug = document.getElementById('debug-info');
            debug.textContent += new Date().toLocaleTimeString() + ': ' + message + '\n';
            console.log(message);
        }

        function clearDebug() {
            document.getElementById('debug-info').textContent = '';
        }

        function testPopupDisplay() {
            log('üß™ Testing popup display...');
            
            // Create test popup
            const popup = document.createElement('div');
            popup.id = 'test-popup';
            popup.innerHTML = `
                <div style="background: white; border: 2px solid #0052cc; padding: 20px; border-radius: 8px;">
                    <h3>ü§ñ Test Popup</h3>
                    <p>This is a test popup to verify display works</p>
                    <button onclick="document.getElementById('test-popup').remove()">Close</button>
                </div>
            `;
            
            // Apply styles
            popup.style.cssText = `
                position: fixed !important;
                top: 100px !important;
                left: 100px !important;
                z-index: 10000 !important;
                display: block !important;
                visibility: visible !important;
                opacity: 1 !important;
            `;
            
            document.body.appendChild(popup);
            log('‚úÖ Test popup created and should be visible');
        }

        function forceShowPopup() {
            log('üîß Force showing mermaid popup...');
            
            const popup = document.getElementById('mermaid-ai-chat-popup');
            if (popup) {
                log('‚úÖ Found mermaid popup, forcing display...');
                
                // Remove all existing styles
                popup.removeAttribute('style');
                
                // Force show with cssText
                popup.style.cssText = `
                    display: block !important;
                    position: fixed !important;
                    top: 50px !important;
                    left: 50px !important;
                    z-index: 10000 !important;
                    visibility: visible !important;
                    opacity: 1 !important;
                    transform: none !important;
                    width: 400px !important;
                    background: white !important;
                    border: 2px solid red !important;
                    border-radius: 8px !important;
                `;
                
                log('‚úÖ Forced popup display with red border');
            } else {
                log('‚ùå Mermaid popup not found');
            }
        }

        function checkPopupStatus() {
            log('üîç Checking popup status...');
            
            const root = document.getElementById('mermaid-ai-chat-root');
            const popup = document.getElementById('mermaid-ai-chat-popup');
            
            log('Root element: ' + (root ? 'EXISTS' : 'NOT FOUND'));
            log('Popup element: ' + (popup ? 'EXISTS' : 'NOT FOUND'));
            
            if (popup) {
                const computed = window.getComputedStyle(popup);
                log('Popup display: ' + computed.display);
                log('Popup visibility: ' + computed.visibility);
                log('Popup opacity: ' + computed.opacity);
                log('Popup position: ' + computed.position);
                log('Popup z-index: ' + computed.zIndex);
                log('Popup left: ' + computed.left);
                log('Popup top: ' + computed.top);
            }
        }

        // Auto check on load
        setTimeout(() => {
            log('üöÄ Page loaded, checking for extension...');
            checkPopupStatus();
        }, 1000);
    </script>
</body>
</html>
